{% extends 'catalog/base.html' %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ —Å—ã—Ä–æ–≤{% endblock %}

{% block content %}
  <h1 class="mb-4">–ö–∞—Ç–∞–ª–æ–≥ —Å—ã—Ä–æ–≤</h1>



  <form method="get" class="row g-3 mb-4 align-items-end" id="filter-form">
    <div class="col-md-4">
      <input type="text" name="q" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." value="{{ request.GET.q }}">
    </div>
    <div class="col-md-3">
      <select class="form-select" name="type" onchange="document.getElementById('filter-form').submit();">
        <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
        {% for type in cheese_types %}
          <option value="{{ type.id }}" {% if type.id|stringformat:"s" == selected_type %}selected{% endif %}>
            {{ type.name }}
          </option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3">
      <select class="form-select" name="order_by" onchange="document.getElementById('filter-form').submit();">
        <option value="name" {% if order_by == 'name' %}selected{% endif %}>–ü–æ –∏–º–µ–Ω–∏</option>
        <option value="price" {% if order_by == 'price' %}selected{% endif %}>–ü–æ —Ü–µ–Ω–µ</option>
        <option value="weight" {% if order_by == 'weight' %}selected{% endif %}>–ü–æ –≤–µ—Å—É</option>
      </select>
    </div>
    <div class="col-md-2">
      <select class="form-select" name="in_stock" onchange="document.getElementById('filter-form').submit();">
        <option value="">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>
        <option value="true" {% if in_stock == 'true' %}selected{% endif %}>–í –Ω–∞–ª–∏—á–∏–∏</option>
        <option value="false" {% if in_stock == 'false' %}selected{% endif %}>–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</option>
      </select>
    </div>
    <div class="col-auto">
      <button type="submit" class="btn btn-warning">üîç –ù–∞–π—Ç–∏</button>
      {% if selected_type or query or in_stock %}
        <a href="{% url 'cheese_list' %}" class="btn btn-outline-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
      {% endif %}
    </div>
  </form>

  {% if cheeses %}
    <ul class="list-group shadow-sm">
      {% for cheese in cheeses %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div style="flex-grow: 1;">
            <strong><a href="{% url 'cheese_detail' cheese.id %}" class="link-dark">{{ cheese.name }}</a></strong>
            ‚Äî {{ cheese.price }} ‚ÇΩ, {{ cheese.weight }} –≥
          </div>
          <div>
            <span class="badge bg-warning text-dark" style="flex-shrink: 0;">
              {{ cheese.cheese_type.name }}
            </span>
            <span class="badge bg-success text-light" {% if not cheese.in_stock %}style="background-color: #dc3545;"{% endif %}>
              {% if cheese.in_stock %}–í –Ω–∞–ª–∏—á–∏–∏{% else %}–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏{% endif %}
            </span>

          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <div class="alert alert-warning mt-4">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üò¢</div>
  {% endif %}
{% endblock %}
